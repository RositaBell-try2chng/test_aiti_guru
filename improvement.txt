Предложения по оптимизации схемы данных и запроса 2.3.1:

1. В сущность Categories добавить поле root_parent_id и тянуть его для каждой категории.
    Таким образом в запросе не нужно будет использовать рекурсию для выявления родителей.

2. Добавить индексы.
    Orders(order_date) → для выборки по дате.
    OrderItems(order_id, product_id) → для джойнов и группировки.
    Products(category_id) → для связи с категориями.

3. Если view будет использоваться часто, но мониторинг в реальном времени не нужен, то можно матереализовать view и обновлять раз в час.